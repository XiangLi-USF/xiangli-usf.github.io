<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="SEACAR Water Quality Pilot Project | Xiang Li | Professional Portfolio">
    <meta name="description" content="">
    <meta name="image" content="https://avatars.githubusercontent.com/u/111073560?s=400&u=f4fc1e6e53c53d74f3c5d2bac139be59c15bebca&v=4">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Xiang Li | Professional Portfolio">
    <meta property="og:url" content="https://xiangli-usf.github.io//projects/SEACAR.html">
    <meta property="og:title" content="SEACAR Water Quality Pilot Project | Xiang Li | Professional Portfolio">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://avatars.githubusercontent.com/u/111073560?s=400&u=f4fc1e6e53c53d74f3c5d2bac139be59c15bebca&v=4">
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/techfolio-theme/default.css">
    <link rel="stylesheet" type="text/css" href="/css/rouge/github.css">
    <!-- Load MathJax if 'mathjax: true' is found in your _config.yml. -->
    
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
    </script>
    

    <title>SEACAR Water Quality Pilot Project | Xiang Li | Professional Portfolio</title>
  </head>
  <body>
  <header class="navbar navbar-expand navbar-light bg-light bg-gradient border-bottom">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Xiang Li</a>
    <div class="ms-auto">
      <ul class="navbar-nav mb-2 mb-lg-0">
        <a class="nav-link" href="/#program">Projects</a>
        <a class="nav-link" href="/#essays">Essays</a>
        <a class="nav-link" href="/cv.html">CV</a>
      </ul>
    </div>
  </div>
</header>

<div class="container py-4">
  <h1 class="display-4">SEACAR Water Quality Pilot Project</h1>
 <p>Under the leadership of Dr. Qiang and Dr. Landry, I worked on this project using statistical methods and tools to monitor water quality in five Florida nature preserves. One of my main tasks was to perform python program development so that statistical analyses could be performed in a more efficient manner.
This original markdown file is written by Dr. Qiang.
<a href="https://github.com/FloridaSEACAR/SEACAR_WQ_Pilot#seacar-water-quality-pilot-project">SEACAR_WQ_Pilot</a></p>

<h1 id="task-1a-exploratory-analysis">Task 1a: Exploratory Analysis</h1>

<p>The exploratory analyses include:</p>
<ol>
  <li>Data slicing and outlier removal</li>
  <li>Line chart of weekly/monthly/yearly count of data records for each WQ parameter in each managed area.</li>
  <li>Line chart with error bars showing monthly and yearly mean and standard deviation of each WQ parameter in each managed area</li>
  <li>Line charts of monthly mean at different stations for each WQ parameter in each managed area.</li>
  <li>Box plots of WQ parameters aggregated by month of the year for each managed area.</li>
  <li>Plots in (4) and (5) of four managed areas with sufficient data are organized by rows (WQ parameter) and columns (managed areas) in order to determine seasonality (https://usf.box.com/s/x05pmyx686hwsp56km0ayelwf1uxxnu2)</li>
  <li>Histogram showing sampling frequencies at each observation locations for each WQ parameters</li>
  <li>Pie chart showing the ratios of random and fixed sampling locations for each WQ parameters</li>
  <li>Bar chart of ratios of fixed sampling locations for each WQ parameters</li>
</ol>

<p>Maps are created to show the spatial distribution of the WQ samples.</p>
<ol>
  <li>Bubble map of sampling points of WQ parameter in each managed area. The Github repository only shows dissolved oxygen and total nitrogen. Maps of other parameters can be easily generated by changing program parameters.</li>
  <li>Bubble maps of sampling points of WQ parameter in each month of a year in each managed area. The Github repository only shows dissolved oxygen and total nitrogen in 2019. Maps of other parameters and in other years can be easily generated by changing program parameters.</li>
  <li>Maps showing locations of different continuous stations are created for each managed area.</li>
</ol>

<p>Analyses in Task 1a are shared in:</p>
<ul>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Exploratory_Analysis/SEACAR_WQ_Exploratory_Analysis_Dis.ipynb">SEACAR_WQ_Exploratory_Analysis_Dis.ipynb</a>: Temporal analysis of discrete data</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Exploratory_Analysis/Sample_Location_Analysis_Dis.ipynb">Sample_Location_Analysis_Dis.ipynb</a>: Spatial locations of discrete data</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Exploratory_Analysis/SEACAR_WQ_Exploratory_Analysis_Con.ipynb">SEACAR_WQ_Exploratory_Analysis_Con.ipynb</a>: Temporal analysis of continuous data: all stations</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Exploratory_Analysis/Sample_Location_Analysis_Con.ipynb">Sample_Location_Analysis_Con.ipynb</a>: Spatial locations of discrete data: all stations</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Exploratory_Analysis/SEACAR_WQ_Exploratory_Analysis_Con_Stations.ipynb">SEACAR_WQ_Exploratory_Analysis_Con_Stations.ipynb</a>: Temporal analysis of continuous data: separate by station</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Exploratory_Analysis/Sample_Location_Analysis_Con_Stations.ipynb">Sample_Location_Analysis_Con_Stations.ipynb</a>: Spatial locations of discrete data: separate by station</li>
</ul>

<h1 id="task-1b-spatial-interpolation">Task 1b: Spatial Interpolation</h1>

<h3 id="1b1-regression-analysis-with-wq-parameters">1b.1 Regression Analysis with WQ Parameters</h3>
<p>Ordinary least square regression (OLS) and Pearson correlation analyses have been conducted to examine the relations between the potential covariates and water quality parameters. The analyses have been conducted with data from 2016 to 2018 in all managed areas and in separate managed areas. The general procedure is:</p>
<ol>
  <li>Preprocessing, including outlier removal, daytime data selection, combine continuous and discrete data, and select data in specific managed areas and years</li>
  <li>Aggregate data in identical locations to mean values in wet and dry seasons (tentative dry season: Nov. â€“ Apr., wet season: May to Oct.)</li>
  <li>Extract values from covariate rasters to water quality locations</li>
  <li>Conduct Pearson correlation and OLS regression analysis in wet and dry seasons</li>
</ol>

<p>Regression and correlation analysis are documented in:</p>

<ul>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Covariates_Analysis/Covariates_Analysis_All.ipynb">Covariates_Analysis_All.ipynb</a>: Analysis with 2016-2018 data in all five managed areas</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Covariates_Analysis/Covariates_Analysis_MA.ipynb">Covariates_Analysis_MA.ipynb</a>: Analysis with 2016-2018 data in all five managed areas</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Covariates_Analysis/Correlation_Covariates.ipynb">Correlation_Covariates.ipynb</a>: Correlation between covariates with 2016-2018 data in all five managed areas</li>
</ul>

<h3 id="1b2-evaluation-of-interpolation-methods">1b.2 Evaluation of Interpolation Methods</h3>
<p>The following interpolation methods are selected for evaluation:</p>
<ul>
  <li><u>Inverse Distance Weighting (IDW)</u>: weighted average of observed data points in the neighborhood (simplest, fast)</li>
  <li><u>Ordinary Kriging (OK)</u>: estimate values by fitting a theoretical variogram model (established method, proven performance)</li>
  <li><u>Empirical Bayesian Kriging (EBK)</u>: estimate values by fitting a non-parametric variogram model (flexible, local model fitting, better suited for complex data pattern)</li>
  <li><u>EBK Regression Prediction (Regression Kriging or RK)</u>: Extends EBK with explanatory variable that known to affect the predicted values (better suited if there are influential covariates)</li>
</ul>

<p>The interpolation programs call functions from ArcGIS python interface (arcpy). The performance of these are evaluated through cross-validation. The purpose is to select the best performed method for batch production. The following metrics were derived to evaluate model performance:</p>

<ul>
  <li><u>Mean Error (ME)</u>: measures the average absolute difference between the observed and predicted values (measures biases)</li>
  <li><u>Root Mean Square Error (RMSE)</u>: square root of average squared difference between observed and predicted values (measures accuracy)</li>
  <li><u>Mean Standardized Error (MSE)</u> standardized by standard deviation of observed values (accuracy relative to data variability)</li>
</ul>

<p>Performance evaluation of interpolation methods are documented in:</p>

<ul>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Method_Comparison/Interpolation_ArcGIS_CH.ipynb">Interpolation_ArcGIS_CH.ipynb</a>: Interpolation evaluation in Charlotte Harbor</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Method_Comparison/Interpolation_ArcGIS_Estero_Bay.ipynb">Interpolation_ArcGIS_Estero_Bay.ipynb</a>: Interpolation evaluation in Estero Bay</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Method_Comparison/Interpolation_ArcGIS_Big_Bend.ipynb">Interpolation_ArcGIS_Big_Bend.ipynb</a>: Interpolation evaluation in Big Bend</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Method_Comparison/RK_Covariate_Assessment_CH.ipynb">RK_Covariate_Assessment_CH.ipynb</a>: Evaluation of regression kriging with different covariates in Charlotte Harbor</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Method_Comparison/RK_Covariate_Assessment_EB.ipynb">RK_Covariate_Assessment_EB.ipynb</a>: Evaluation of regression kriging with different covariates in Estero Bay</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Method_Comparison/RK_Covariate_Assessment_EB.ipynb">RK_Covariate_Assessment_BB.ipynb</a>: Evaluation of regression kriging with different covariates in Big Bend</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Method_Comparison/RK_Covariate_Assessment_Biscayne.ipynb">RK_Covariate_Assessment_Biscayne.ipynb</a>: Evaluation of regression kriging with different covariates in Biscayne Bay</li>
  <li><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Method_Comparison/RK_Covariate_Assessment_Biscayne.ipynb">RK_Covariate_Assessment_GTM.ipynb</a>: Evaluation of regression kriging with different covariates in Guana Tolomato Matanzas National Estuarine Research Reserve</li>
</ul>

<h3 id="1b3-automated-interpolation">1b.3 Automated Interpolation</h3>
<p>Regression Kriging is applied to interpolate water quality parameters (Dissolved Oxygen, Total Nitrogen, Salinity, Secchi Depth, and Turbidity) in all seasons defined in this <a href="https://github.com/FloridaSEACAR/WQ_Summaries/blob/gh-pages/OEATUSF_Geospatial_TempSeasons.csv">table</a> for all managed areas. The interpolation algorithm utilizes the optimal combination of covariates identified in Task 1b.2.</p>

<ul>
  <li>
    <p><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/Spatial_Interpolation/Automate_Interpolation.ipynb">Automate_Interpolation.ipynb</a>: The main function that calls the interpolation function in autointerpolation.py. The program loads preprocessed data to save computing time.</p>
  </li>
  <li>
    <p><a href="https://github.com/qiang-yi/SEACAR_WQ_Pilot/blob/main/misc/autointerpolation.py">autointerpolation.py</a>: The interpolation function that can be applied to selected data points. The interpolation function is used in the main function to interpolate maps in all seasons.</p>
  </li>
</ul>

<h1 id="task-1c-gap-analysis">Task 1c: Gap Analysis</h1>
<h3 id="1c1-overall-visualization">1c.1 Overall Visualization</h3>
<p>Kernel density estimation (KDE) maps and aggregated standard error of prediction (SEP) maps are created in pairs for visual detection of sampling gaps and redundancies. The KDE and SEP maps are created from all data points from 2015 to 2019 for each parameter and in each managed area.</p>

<p><a href="Gap_Analysis/Gap_Analysis_Part1.md">Gap_Analysis_Part1.md</a>: Pairs of KDE and SEP maps for all sampling points from 2015 to 2019. The executable Python codes to generate these maps can be found <a href="Gap_Analysis/Gap_Analysis_Part1.ipynb">here</a></p>

<h3 id="1c2-seasonal-visualization">1c.2 Seasonal Visualization</h3>
<p>Kernel density estimation (KDE) maps and aggregated standard error of prediction (SEP) maps are created for spring, summer, fall and winter from 2015 to 2019 for each parameter and in each managed area.</p>

<p><a href="Gap_Analysis_Part2.md">Gap_Analysis_Part2.md</a>: Pairs of seasonal KDE and SEP maps. The executable Python codes to generate these maps can be found <a href="Gap_Analysis/Gap_Analysis_Part2.ipynb">here</a></p>

<h3 id="1c3-identify-redundancy-and-gaps">1c.3 Identify Redundancy and Gaps</h3>
<p>The KDE and SEP maps generated in Task 1c.1 are reclassified into low, neutral and high using 25 and 75 percentile thresholds. Then, the KDE and SEP maps are overlaid to identify redundant sampling points and gap areas according to the table below.</p>

<table>
  <thead>
    <tr>
      <th>Kernel density</th>
      <th>Standard error of prediction</th>
      <th>Implication</th>
      <th>Output</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>High</td>
      <td>High</td>
      <td>Natural variation, potentially seasonal issue, or might be unexplained variation</td>
      <td>Display seasonal maps for SEACAR team to consider explanation</td>
    </tr>
    <tr>
      <td>High</td>
      <td>Low</td>
      <td>Potential redundancy</td>
      <td>Identify specific sampling points within these areas</td>
    </tr>
    <tr>
      <td>Low</td>
      <td>Low</td>
      <td>No change needed / low priority</td>
      <td>Reference only</td>
    </tr>
    <tr>
      <td>Low</td>
      <td>High</td>
      <td>Potential need for more stations</td>
      <td>Identify areas on the map</td>
    </tr>
  </tbody>
</table>

</div>

<footer class="navbar navbar-expand navbar-light bg-light bg-gradient border-top">
  <div class="container-fluid">
    <div class="ms-auto">
      <ul class="navbar-nav mb-2 mb-lg-0">
        <small><a class="nav-link" href="https://techfolios.github.io">Made with Techfolios</a></small>
      </ul>
    </div>
  </div>
</footer>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
  </body>
</html>
